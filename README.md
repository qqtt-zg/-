# 大诚重命名工具

一个功能强大的文件批量重命名工具，专为生产环境设计，支持多种重命名规则、Excel数据导入、PDF处理等高级功能。

## 主要功能

### 🔄 批量文件重命名
- 支持多种重命名规则和模式
- 智能识别返单文件（带前缀标识）
- 正则表达式匹配和字段提取
- 预览重命名结果，确保准确性

### 📊 Excel数据导入
- 支持从Excel文件批量导入重命名数据
- 自动数据匹配和字段提取
- 支持列组合功能
- 智能处理未分组项目

### 📋 事件分组管理
- 9个专业预定义分组（订单、材料、数量、工艺、客户、备注、行数、列数、未分组）
- TreeView层级化管理
- 支持拖拽排序和项目移动
- 独立前缀配置和启用/禁用控制

### 🏷️ 保留分组冲突检测
- 智能检测保留冲突
- 友好的冲突提示对话框
- 自动清理现有保留状态

### 📄 PDF处理功能
- PDF文件预览和处理
- 支持形状识别（直角矩形、圆形、圆角矩形、异形）
- PDF缩放和导航功能
- 折叠动画效果

### 🎨 现代化UI设计
- Material Design风格界面
- SVG图标支持
- 响应式布局
- 字体自定义功能

## 技术栈

- **框架**: .NET Framework 4.8
- **UI框架**: WinForms + AntdUI
- **语言**: C# 9.0
- **主要依赖**:
  - AntdUI 2.1.12 - 现代化UI组件库
  - EPPlus 5.0.4 - Excel文件处理
  - iText 9.3.0 - PDF处理
  - Newtonsoft.Json 13.0.3 - JSON序列化
  - Svg 3.4.7 - SVG图标支持
  - Ookii.Dialogs.WinForms 4.0.0 - 对话框增强

## 安装要求

- Windows 7/8/10/11
- .NET Framework 4.8 或更高版本
- 至少 100MB 可用磁盘空间

## 版本历史

### v2.0.6 (2025-12-13)
- **新文件数据匹配修复**: 修复新文件处理时未进行数据匹配的问题
- **参数验证增强**: 当Excel正则和主正则都为空时，提示用户缺少必要参数
- **列组合自动补全**: 改进列组合功能，系统自动尝试从Excel行数据中提取行列数
- **未分组项目分隔符修复**: 修复多个未分组项目之间分隔符显示问题
- **日志记录完善**: 增强数据匹配和列组合过程的日志记录

### v2.0.5
- **智能返单文件识别**: 自动检测文件名中的保留格式前缀
- **分隔符处理规则优化**: 修复分组间分隔符显示问题
- **混合逻辑处理增强**: 优化混合场景的分隔符处理
- **状态栏规则显示完善**: 修复状态栏中规则显示的分隔符问题

### v2.0.4
- **版本号统一**: 修复程序集版本号与安装包版本号不一致问题
- **关于界面优化**: 精简版本说明内容
- **功能说明整合**: 核心功能以简洁的两列布局展示

### v2.0.3
- **数据同步机制优化**: 修复保留功能中文件重命名后UI显示不一致问题
- **保留值恢复逻辑增强**: 完善RestorePreservedFields方法
- **UI刷新机制改进**: 优化RefreshDgvFiles方法
- **数据一致性保证**: 实现文件系统重命名结果与界面显示数据的完全一致性

### v2.0.0 (重大版本升级)
- **保留分组冲突检测功能**: 实现智能冲突检测机制
- **事件分组管理功能升级**: TreeView层级化管理，支持拖拽排序
- **数据模型重构优化**: 重构FileRenameInfo核心模型
- **自动化测试覆盖增强**: 新增全面的单元测试和集成测试
- **Chrome MCP自动化扩展**: 集成Chrome DevTools自动化测试功能
- **UI现代化优化**: 实现SVG图标资源支持
- **性能优化和稳定性提升**: 优化内存使用，完善异常处理机制

## 使用指南

### 基本重命名流程
1. 将需要重命名的文件添加到程序中
2. 设置重命名规则（支持正则表达式）
3. 预览重命名结果
4. 确认执行批量重命名

### Excel数据导入
1. 准备包含重命名数据的Excel文件
2. 点击"导入Excel"按钮
3. 选择Excel文件和对应的工作表
4. 配置列映射关系
5. 导入数据并应用重命名

### 事件分组管理
1. 在事件管理界面中创建或编辑分组
2. 将相关项目拖拽到对应分组
3. 配置分组前缀和规则
4. 启用或禁用特定分组

### PDF处理
1. 选择需要处理的PDF文件
2. 使用PDF预览功能查看内容
3. 选择识别的形状类型
4. 应用处理规则

## 项目结构

```
大诚工具箱630-整理好/
├── src/WindowsFormsApp3/          # 主程序源代码
│   ├── Forms/                     # 窗体文件
│   │   ├── Main/                  # 主窗体
│   │   ├── Dialogs/              # 对话框
│   │   └── Utils/                # 工具窗体
│   ├── Services/                 # 业务逻辑服务
│   ├── Models/                   # 数据模型
│   ├── Utils/                    # 工具类
│   ├── Interfaces/               # 接口定义
│   └── Resources/                # 资源文件
├── installers/                    # 安装包配置
├── tests/                         # 测试项目
└── docs/                          # 文档
```

## 开发者信息

- **开发者**: 大诚软件
- **版本**: 2.0.6
- **许可证**: 商业软件

## 支持与反馈

如有问题或建议，请联系技术支持。

---

© 2025 大诚软件。保留所有权利。